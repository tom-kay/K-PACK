<?xml version="1.0" encoding="utf-8"?>
<SmartSqlMap Scope="MenuMng" xmlns="http://SmartSql.net/schemas/SmartSqlMap.xsd">
	<Statements>
		<Statement Id="SelectAdd">
			, `menu`.`DelYn`
			, `menu`.`CreateDt`
			, `menu`.`UpdateDt`
			, `menu`.`DeleteDt`
		</Statement>
		
		<Statement Id="selectMenuMasterList">
			select `menu`.`MenuId`,
			`menu`.`ParentId`,
			`menu`.`MenuName`,
			`menu`.`MenuType`,
			`menu`.`Namespace`,
			`menu`.`FormName`,
			`menu`.`OrderSeq`,
			`menu`.`DepthNo`,
			`menu`.`UseYn`
			<Include Prepend="" RefId="SelectAdd"/>
			from tb_menumaster AS menu
			where UseYn = 'Y'
			and DelYn != 'Y'
			order by depthNo, orderseq;
		</Statement>

		<Statement Id="selectMenuMasterListByParentKey">
			select `menu`.`MenuId`,
			`menu`.`ParentId`,
			`pmenu`.`MenuName` as ParentName,
			`menu`.`MenuName`,
			`menu`.`MenuType`,
			`typecd`.`name` as MenuTypeName,
			`menu`.`Namespace`,
			`menu`.`FormName`,
			`menu`.`OrderSeq`,
			`menu`.`DepthNo`,
			`menu`.`UseYn`
			<Include Prepend="" RefId="SelectAdd"/>
			from tb_menumaster AS menu
			left join tb_menumaster AS pmenu
			on pmenu.MenuId = menu.ParentId
			left join tb_codedetail	AS typecd
			on typecd.MasterCode = 'MENUTYPE'
			and typecd.code = menu.menutype
			where 1=1
			and ifnull(menu.ParentId,'') = @ParentId
			order by depthNo, orderseq;
		</Statement>

		<Statement Id="selectMenuMasterByKey">
			select `menu`.`MenuId`,
			`menu`.`ParentId`,
			`pmenu`.`MenuName` as ParentName,
			`menu`.`MenuName`,
			`menu`.`MenuType`,
			`typecd`.`name` as MenuTypeName,
			`menu`.`Namespace`,
			`menu`.`FormName`,
			`menu`.`OrderSeq`,
			`menu`.`DepthNo`,
			`menu`.`UseYn`
			<Include Prepend="" RefId="SelectAdd"/>
			from tb_menumaster AS menu
			left join tb_menumaster AS pmenu
			on pmenu.MenuId = menu.ParentId
			left join tb_codedetail	AS typecd
			on typecd.MasterCode = 'MENUTYPE'
			and typecd.code = menu.menutype
			where 1=1
			and ifnull(menu.MenuId,'') = @MenuId
			order by depthNo, orderseq;
		</Statement>

		<Statement Id="insertMenuMaster">
			INSERT INTO `soodal`.`tb_customer`
			(`CustCode`,
			`CustName`,
			`CompanyNo`,
			`Address1`,
			`Address2`,
			`TelNo`,
			`FaxNo`,
			`Email`,
			`NationCode`,
			`DealTypeSale`,
			`DealTypeBuy`,
			`DealTypeProc`,
			`DealTypeGeneral`,
			`OwnerName`,
			`BankName`,
			`AccountNo`,
			`Depositor`,
			`Remark`,
			`CompanyCode`,
			`DelYn`,
			`CreateId`,
			`CreateDt`)
			VALUES
			(@CustCode,
			@CustName,
			HEX(AES_ENCRYPT(@CompanyNo, @CustCode)),
			@Address1,
			@Address2,
			@TelNo,
			@FaxNo,
			@Email,
			@NationCode,
			@DealTypeSale,
			@DealTypeBuy,
			@DealTypeProc,
			@DealTypeGeneral,
			@OwnerName,
			@BankName,
			@AccountNo,
			@Depositor,
			@Remark,
			@CompanyCode,
			'N',
			@CreateId,
			now())
			ON DUPLICATE KEY UPDATE
			`CustName` = @CustName,
			`CompanyNo` = HEX(AES_ENCRYPT(@CompanyNo, CustCode)),
			`Address1` = @Address1,
			`Address2` = @Address2,
			`TelNo` = @TelNo,
			`FaxNo` = @FaxNo,
			`Email` = @Email,
			`NationCode` = @NationCode,
			`DealTypeSale` = @DealTypeSale,
			`DealTypeBuy` = @DealTypeBuy,
			`DealTypeProc` = @DealTypeProc,
			`DealTypeGeneral` = @DealTypeGeneral,
			`OwnerName` = @OwnerName,
			`BankName` = @BankName,
			`AccountNo` = @AccountNo,
			`Depositor` = @Depositor,
			`Remark` = @Remark,
			`DelYn` = 'N',
			`UpdateId` = @UpdateId,
			`UpdateDt` = now(),
			`DeleteId` = null,
			`DeleteDt` = null
			;
		</Statement>
	</Statements>
</SmartSqlMap>